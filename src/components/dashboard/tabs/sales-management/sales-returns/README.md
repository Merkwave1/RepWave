# Sales Return Forms - الحل الموحد

## نظرة عامة
تم إنشاء حل موحد لنماذج مرتجعات البيع بحيث يمكن استخدام نفس الكومبوننت للإضافة والتعديل.

## الملفات الرئيسية

### 1. SalesReturnForm.jsx (الكومبوننت الموحد)
الملف الأساسي الذي يحتوي على كامل الوظائف المطلوبة لإضافة وتعديل المرتجعات.

**الخصائص:**
- `isEditMode` (Boolean): تحديد ما إذا كان الكومبوننت في وضع التعديل أم الإضافة
- `returnItem` (Object): بيانات المرتجع المراد تعديله (فقط في وضع التعديل)
- `clients` (Array): قائمة العملاء
- `onSubmit` (Function): دالة استلام البيانات عند الحفظ
- `onCancel` (Function): دالة الإلغاء

### 2. SalesReturnsTab.jsx (المحدث)
الملف الرئيسي محدث لاستخدام الكومبوننت الموحد.

## الميزات المطبقة

### الإضافة (isEditMode = false):
- ✅ اختيار العميل والطلب المرتبط
- ✅ تحميل الأصناف من الطلب تلقائياً
- ✅ تعديل الكميات والأسعار
- ✅ حساب الضرائب والإجماليات
- ✅ إعدادات الخصم اليدوي
- ✅ حذف الأصناف غير المرغوبة

### التعديل (isEditMode = true):
- ✅ تحميل البيانات الحالية تلقائياً
- ✅ منع تعديل العميل ورقم الطلب (للعرض فقط)
- ✅ تعديل الأسعار والتواريخ والحالات
- ✅ نفس واجهة الإضافة بالضبط
- ✅ حفظ التغييرات بواسطة API التعديل

## التصميم الموحد

### جدول الأصناف:
- العنوان: "الكمية المطلوبة والمرتجعة والمتبقية"
- عرض سعر الضريبة مع النسبة المئوية
- ملخص الطلب في سطر واحد

### نظام الحالات:
- عرض الحالات بالعربية في الواجهة
- تحويل تلقائي للإنجليزية عند الحفظ
- دعم جميع الحالات: (مسودة، في الانتظار، مُعتمد، مرفوض، تم المعالجة، ملغي)

### إعدادات الخصم:
- خيار تفعيل الخصم اليدوي
- تخطيط 3 أعمدة للوضوح
- عرض القيمة المطبقة فعلياً

## استخدام الكومبوننت

```jsx
// للإضافة
<SalesReturnForm
  isEditMode={false}
  onSubmit={handleAddReturn}
  onCancel={() => setCurrentView('list')}
  clients={clients}
/>

// للتعديل
<SalesReturnForm
  isEditMode={true}
  returnItem={selectedReturn}
  onSubmit={(data) => handleUpdateReturn(id, data)}
  onCancel={() => setCurrentView('list')}
  clients={clients}
/>
```

## التحديثات المطبقة في SalesReturnsTab.jsx

1. **استيراد موحد:**
```jsx
import SalesReturnForm from './SalesReturnForm';
```

2. **استخدام موحد:**
- استبدال `AddSalesReturnForm` بـ `SalesReturnForm` مع `isEditMode={false}`
- استبدال `UpdateSalesReturnForm` بـ `SalesReturnForm` مع `isEditMode={true}`

## الملفات المساعدة

### AddSalesReturnFormNew.jsx & UpdateSalesReturnFormNew.jsx
ملفات wrapper للتوافق مع النظام القديم إذا لزم الأمر.

### index.js
ملف تصدير موحد لجميع الكومبوننتات.

## الملفات القديمة
- `AddSalesReturnForm.jsx` (الأصلي)
- `UpdateSalesReturnForm.jsx` (الأصلي)

هذه الملفات لا تزال موجودة للرجوع إليها عند الحاجة.

## فوائد الحل الموحد

1. **صيانة أسهل:** كود واحد بدلاً من اثنين
2. **تجربة متسقة:** نفس الواجهة والتصميم تماماً
3. **أقل تعقيداً:** منطق واحد للتعامل مع البيانات
4. **مرونة عالية:** إضافة ميزات جديدة مرة واحدة
5. **أخطاء أقل:** اختبار واحد بدلاً من اثنين

## الخطوات التالية

يمكن حذف الملفات القديمة بأمان بعد التأكد من عمل النظام الجديد بشكل صحيح:
- `AddSalesReturnForm.jsx`
- `UpdateSalesReturnForm.jsx`